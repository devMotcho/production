{% extends 'main.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block scripts %}
<script src="{% static 'orders/search.js' %}" defer></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
{% endblock scripts %}

{% block content %}
<!--Ínicio Modal -->
<div class="modal fade" id="reportModal" tabindex="-1" aria-labelledby="reportModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="ModalLabel">
                    <a href="">
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32"
                            viewBox="0 0 32 32">
                            <title>Seta</title>
                            <path
                                d="M13.723 2.286l-13.723 13.714 13.719 13.714 1.616-1.611-10.96-10.96h27.625v-2.286h-27.625l10.965-10.965-1.616-1.607z">
                            </path>
                        </svg>
                    </a>
                    <h4>Relatório</h4>
                </div>
            </div>
            <div class="modal-body" id="modal-body">
                <div id="alert-box"></div>
                <form class="report-form" method="POST" action="" id="report-form">
                    {% csrf_token %}
                    <div class="form__group" id="report-form">
                        {{report_form|crispy}}
                    </div>
                    <div class="form__action">
                        <a class="btn btn-outline-danger" href="">Cancelar</a>
                        <button class="btn btn-outline-success" type="submit">Submeter</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!--Fim Modal -->





<div class="container">
    <div class="row">
        <div class="col-3">
            <div class="card search__form shadow">
                <h4 class="card-header bg-dark text-warning text-center">
                    Procurar Dados Encomenda
                </h4>
                <div class="card-body">
                    <form action="" method="POST">
                        {% csrf_token %}
                        {{form|crispy}}
                        <button class="btn btn-outline-warning p-2 my-2" type="submit">Procurar</button>
                    </form>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card shadow bg-white text-center p-2 my-2 border-none">
                <div class="chart__image">
                    <img src="data:image/png;base64, {{chart|safe}}" id="img">
                </div>
            </div>
        </div>
        <div class="report">
            <button class="btn btn-outline-danger" id="report-btn" data-bs-toggle="modal"
                data-bs-target="#reportModal">Relatório</button>
        </div>
    </div>

    <br>
    <div class="row">
        <div class="col">
            <div class="card">
                <h4 class="card-header bg-dark text-center text-warning">
                    Tabela Encomendas
                </h4>
                <div class="card-body">
                    <table class="table table-bordered">
                        <thead>
                            <tr class="table-dark text-center">
                                {% for k, v in df_dict.items %}
                                <th>{{k}}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>

                            {% for rec in df_rec %}
                            <tr>
                                {% for i2, k2 in rec.items %}
                                <td>{{k2}}</td>
                                {% endfor %}
                            </tr>
                            {% endfor %}

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    {% if dataframe %}
    dataframe
    {{dataframe|safe}}
    positions
    {{positions_df|safe}}
    {% endif %}
</div>




{% endblock content %}